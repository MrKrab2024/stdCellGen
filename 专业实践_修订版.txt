专业实践报告（修订版）

一、实践单位与岗位环境概述
本次专业实践时间为 2024 年 7 月至 2025 年 12 月，实践单位为成都华大九天科技有限公司平台技术部。该部门承担底层数据库、几何引擎、版图编辑、物理验证与EDA基础平台等核心模块的研发任务，工程规模大、技术复杂度高、规范体系完备，适合系统提升工程能力与算法落地能力。进入部门后，我完成入职培训与研发岗位技术考核，随后加入实际项目，逐步融入代码规范、评审流程、持续集成、问题跟踪与跨团队协作机制。

二、实践目标与计划
结合研究生阶段的方向（集成电路与EDA算法），我将本次实践定位为“从学术研究走向工业级EDA研发”的过渡阶段，确立了三类目标：一是熟悉大型EDA软件的工程化体系与协作流程；二是把电路、版图、规则等理论认知转化为可运行的工程实现，补齐“理论—工程—验证”的闭环；三是从工程问题中抽象研究议题，形成可验证的方法与数据，为后续学位论文奠基。对应目标，我制定了分阶段计划：前期聚焦平台与数据模型学习，中期切入具体算法研发，后期对成果做系统验证、文档化与问题复盘。

三、实践任务与职责概览
我先后参与两个项目：
1）paperFloorPlan 原型项目：负责部分 GUI 交互与数据绑定，实现基于 Qt 的视图管理、图形对象交互、海量图形的增量刷新与事件驱动机制；在 OpenAccess（OA）兼容数据库上完成对象查询、层次遍历、几何计算与属性缓存优化；通过剖析绘制管线与数据通道，掌握平台式EDA工具的工程骨架。
2）标准单元库自动化生成项目：承担“匹配—布局—布线”三段式架构的重构与落地。实现统一 CLI 接口（-config），将库网表、工艺/规则、运行清单、阶段开关（match/place/route）、增量复用（如仅布局或布线）等收敛到配置；在匹配阶段实现结构化合并与自上而下匹配的规则；在布局阶段预留 RL+GNN 的 Python Hook；在布线阶段明确 M0 水平、M1 垂直与 9 轨默认参数，并对轨道、对齐与约束进行基础建模。

四、关键技术问题与解决方案
1）网表源/漏定向（S/D Orientation）
问题：标准单元网表中 MOS 的 S/D 在拓扑上等价，但布局/匹配期望统一方向。若直接把电源或共享网作为联结点进行串联合并，容易“吞入”关键端点，导致路径与方向不稳定。
做法：
- 串联分组：只在“非电源、非共享且度=2”的 DS 网上做联结；电源与共享网只作为组外露端点；支持串联长度≥2；端点相同的串联链做并联合并（仅为简化，后续按链逐路径定向）。
- 共享网：以 P/N 两侧 DS 集合的交为 shared_nets；在分组时作为边界。
- 传输门识别：仅当端点都属于 shared_nets，且该端对在 P/N 两侧同时出现时，才认定为“传输门端对”并跳过；被跳过器件以 skipped_tg_devices 记录，而不计入 ambiguous。
- 路径确认：从电源出发做基于路径的 BFS，仅在当前路径出现回环时剪枝；只在抵达共享网时确认整条路径的方向；对端点一致的并联合并组，逐条 src→dst 路径独立定向，避免贪心走回端点导致“方向反向”的现象。
- 输出：写出定向后网表、JSON 报告与日志；报告包含 series_groups_pre/post、oriented_group_dirs、components、ambiguous_devices、skipped_tg_devices 等，便于溯源与排查。
效果：定向一致性显著提升；全库设备 1962 个，定向 1962 个，ambiguous 0；为后续匹配稳定性奠定基础。

2）结构化匹配（Structural Matcher）
问题：PMOS/NMOS 网络存在对称性，但实际网表包含众多非镜像子结构（异步置复位、守门/保持等）。若仅以贪心或浅层规则配对，易造成非叶子层级失败。
做法：
- 自下而上合并：在子图内迭代识别串/并联，把串联链与并联集合逐层合并，按轮次赋 level；若某轮既未找到串也未找到并，且组数>1，则将剩余合成一个“并联合并组”（作为占位层）。
- 自上而下匹配：先判定顶层 level 是否一致；一致则递归向下，优先配对“晶体管数量与栅极相似度”较高的子组；若在非0层级出现无法配对，按规则进入“简单匹配”回退（接口预留），当前版本保守标记为失败；叶子层级无法配对的 MOS 进入离散集合。
- 并联组放置：对 level=1 匹配成功的并联组，按“串联保持顺序、并联可重排/翻转”的约束，以最大化共享栅极为目标放置；若两侧数量不等，允许在首/尾插入 dummy MOS（保持连续），再按纵向一一对应合成 pair。
- 匈牙利匹配：在存在多候选子组时，按“层级一致+规模/栅极相似度”构造代价，进行最大权匹配，提高全局一致性。
效果：在接入定向后网表后，匹配成功率由 67.2% 提升至 95.0%（180 个单元中 171 个成功）。

3）异步宏结构的处理
现状问题：异步置/复位相关的外绕支路（如 VSS→pd3→SH、VDD→net077→pd2→SH 等）在 P/N 两侧内部网名与串并层级不严格对齐，易在非叶层级触发失败。
改进方向：在递归匹配前识别“SET/RESET 宏锥”，以端点集合与门控集合为约束抽象成宏组，内部再做路径定向与匈牙利配对；必要时对宏组放宽“非叶失败”判定，避免全局失败由局部外绕支路触发。

五、工程化与协作实践
- 代码规范：遵循团队 C++/Python 规范与提交准则，模块接口清晰、异常路径与日志齐备；公共头文件抽象语义、避免泄漏实现细节。
- 配置与复用：统一 -config 入口，支持“只匹配/只布局/只布线”以及连续链路复用；明确 vdd_net/vss_net、轨道数、金属层走向等关键参数；产物以 CSV/JSON/文本多形态输出。
- 性能与稳定：串联分组与路径确认按子图并行化；长链路调试场景保留轻量级 trace；对异常单元写出 debug JSON，便于快速复盘。
- 跨团队协作：与算法、版图、验证同事周会同步风险与进度；需求澄清与评审机制确保实现与预期一致；对外接口稳定后再进行下游联调。

六、主要成果与量化指标
- 可运行的标准单元生成器骨架（C++ 主体，Python RL Hook），形成 matcher/placer/router 三段式架构；
- 统一的配置与批处理入口（-config），支持按清单批量运行；
- 可解释的网表定向器（oriented_asap7.sp、orient_report.json、orient_log.txt），覆盖全库并输出调试字段；
- 结构化匹配器（支持层级一致性、并联放置、匈牙利匹配与离散集）；
- 全库结果：成功 171/180（95.0%），失败 9/180（主要集中在异步触发器家族，原因已定位）。

七、问题与不足（客观反思）
- 理论支撑仍需加强：对称性驱动布局与结构化匹配目前以工程有效性为主，形式化完备性与边界条件分析不足；对极端网表的性能界限尚未系统证明。
- 系统联动考虑不够：评估指标偏几何与布线友好性，端到端 PPA（时序/功耗/面积）联动不足；后续需在流程级联动上补强。
- 智能方法尚未实装：已在布局侧预留 RL+GNN 钩子，但尚未形成可复现实验；需要构建可控数据集与指标体系，验证策略收敛与泛化能力。
- 知识沉淀仍可提升：阶段性文档与失败案例归档不够系统，降低了成果的可复用性与团队扩散效率。

八、经验与方法论（可迁移）
- 把“边界”显式化：电源与共享网作为组边界而非联结点，能显著减少错误合并，提升后续算法稳定性；
- 路径优先而非局部贪心：对并联合并组逐路径定向，优于单路径覆盖，能避免方向回折；
- 先抽象、再匹配：对异步宏支路先做宏抽象再配对，可弱化内部网名差异；
- 输出可解释：把“过程变量”变成“报告字段”，提升调试准确性与跨组沟通效率。

九、后续计划
- 理论化：开展对称组完备性、配对可行域与复杂度界的形式化研究，完善理论支撑；
- 宏结构：落地 SET/RESET 宏识别与宏配对，优先消除剩余 9 个失败单元；
- 智能化：在布局阶段实装 RL+GNN，构建训练/验证基准与奖励设计；
- 联动化：将布局结果接入路由与时序评估，建立端到端 PPA 指标闭环；
- 文档化：沉淀技术报告与开源原型，提升可传播与可复现性。

结语
本次专业实践使我在平台式EDA工程与核心算法落地两方面都获得了系统锻炼与客观进展。我将以此为起点，继续在理论严谨性、工程完备性与系统协同上补齐短板，力求形成兼具研究深度与产业价值的持续产出。
